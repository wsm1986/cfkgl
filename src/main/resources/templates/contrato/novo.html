<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	th:include="fragments/template :: page">
<head>
<title></title>
</head>
<body>
	<div th:fragment="content">
		<form method="POST" th:object="${contrato}" th:action="@{/contrato/salvar}" action="#" id="form">
			<div class="row">
				<div class="col-lg-142">
					<h1 class="page-header">IMPLATAÇÃO DE CONTRATO</h1>
					<div class="alert  alert-danger  alert-dismissible" role="alert"
							th:if="${#fields.hasAnyErrors()}">
							<button type="button" class="close" data-dismiss="alert"
								aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
							<th:block th:each="erro : ${#fields.detailedErrors()}">
								<div>
									<i class="fa  fa-exclamation-circle"></i> <span
										th:text="${erro.message}">ERRO informado.</span>
								</div>
							</th:block>
					</div>					
					<div class="row">
						<div class="col-sm-4  form-group" th:classappend="${#fields.hasErrors('corretor')} ? has-error">
							<label for="nome" class="control-label">Corretor</label> 
							<select class="form-control" th:field="*{corretor}">
								<option th:each="corretor : ${corretores}"
									th:text="${corretor.nome} +' | CPF: ' + |${corretor.cpfCnpj} " th:value="${corretor.id}"
								>
								</option>
							</select>
						</div>
						
						<div class="col-sm-6  form-group" th:classappend="${#fields.hasErrors('subProduto')} ? has-error">
							<label for="nome" class="control-label">Convenio</label> 
							<select class="form-control" th:field="*{subProduto}">
								<option th:each="subProduto : ${subProdutos}"
									th:text="${subProduto}" th:value="${subProduto.id}">
								</option>
							</select>
						</div>
						<div class="col-sm-1  form-group">
							<label for="nome" class="control-label">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label> 
						
							<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#newSession">Adicionar</button>
						</div>

					</div>
					
						<h4 class="page-header">DADOS DO CONTRATO</h4>
						
						<div class="col-sm-2  form-group" th:classappend="${#fields.hasErrors('codigoContrato')} ? has-error">
							<label for="idade" class="control-label">Numero Proposta</label> <input
								id="idade" type="text" class="form-control somenteNumero"
								th:field="*{codigoContrato}" />
						</div>


						<div class="col-sm-2  form-group" th:classappend="${#fields.hasErrors('dtCadastro')} ? has-error">
							<label for="dtVencimentoConverter" class="control-label">Data Cadastro </label>
							<div class='input-group date' id='dataCadastro'>
								<input type='text' class="form-control" th:field="*{dtCadastro}"		placeholder="ddmmyyyy" /> 
								<span class="input-group-addon">
									<span class="glyphicon glyphicon-calendar"></span>
								</span>
							</div>
						</div>


						<div class="col-sm-2  form-group" th:classappend="${#fields.hasErrors('dtAssinatura')} ? has-error">
							<label for="dtVencimentoConverter" class="control-label">Data Assinatura </label>
							<div class='input-group date' id='dataAssinatura'>
								<input type='text' class="form-control" th:field="*{dtAssinatura}"		placeholder="ddmmyyyy" /> 
								<span class="input-group-addon">
									<span class="glyphicon glyphicon-calendar"></span>
								</span>
							</div>
						</div>
						
						

						<div class="col-sm-2  form-group" th:classappend="${#fields.hasErrors('dtVigencia')} ? has-error">
							<label for="dtVencimentoConverter" class="control-label">Data Vigencia </label>
							<div class='input-group date' id='dataVigencia'>
								<input type='text' class="form-control" th:field="*{dtVigencia}"		placeholder="ddmmyyyy" /> 
								<span class="input-group-addon">
									<span class="glyphicon glyphicon-calendar"></span>
								</span>
							</div>
						</div>


						<div class="col-sm-2  form-group">
							<div class="form-group" th:classappend="${#fields.hasErrors('valor')} ? has-error">
								<label for="nome" class="control-label">Valor</label> 
								<input id="valor" type="text" class="form-control money" th:field="*{valor}"/>
							</div>
						</div>
						
						<div class="col-sm-6  form-group" th:classappend="${#fields.hasErrors('segurado.nome')} ? has-error">
							<label for="segurado" class="control-label">Nome Segurado</label> 
							<input id="segurado" type="text" class="form-control " th:field="*{segurado.nome}"/>
							<!-- <a class="btn btn-primary" id="testarImpressora" th:text="#{button.test.printer}"></a> -->
						</div>
						
						<div class="col-sm-2  form-group">
							<div class="form-group" th:classappend="${#fields.hasErrors('segurado.cpfCnpj')} ? has-error">
								<label for="nome" class="control-label">C.P.F</label> 
								<input id="cpf" type="text" class="form-control cpf" th:field="*{segurado.cpfCnpj}"/>
							</div>
						</div>


						<div class="col-sm-2  form-group">
							<div class="form-group" th:classappend="${#fields.hasErrors('segurado.quantVidas')} ? has-error">
								<label for="nome" class="control-label">Qaunt. Vidas</label> 
								<input id="cpf" type="text" class="form-control valor" th:field="*{segurado.quantVidas}"/>
							</div>
						</div>

<!-- 						
						<div class="row">
			                    <div class="panel panel-default">
			                        <div class="panel-heading">
			                        </div>
			                        <div class="panel-body">
			                            <table width="100%" class="table table-striped table-bordered table-hover"  id="products-table">
			                                <thead>
			                                    <tr>
			                                        <th>Nome</th>
			                                        <th>CNPJ</th>
			                                        <th>Excluir</th>
			                                    </tr>
			                                </thead>
			                                <tbody>
			                                    <tr class="odd gradeX" th:each="segurado : ${contrato.segurados}">
													<td th:text="${segurado.nome}">1</td>
													<td th:text="${segurado.cpfCnpj}">1</td>
													<td >	  </td>
			                                    </tr>
			                                    
			                                </tbody>
			                            </table>
			                        </div>
			                    </div>
		                </div> -->
						
				</div>
			</div>
			
			<!-- <button onclick="AddTableRow()"  class="btn btn-primary" type="button"  >Adicionar</button> -->				
			<button type="submit" class="btn btn-primary">Salvar</button>
		</form>
		
		
		
		
		
				<!-- Modal -->
			<div id="newSession" class="modal fade" role="dialog" >
			  	<div class="modal-dialog">
			<div class="row">
				<div class="panel panel-default" id="msg">
				</div>
			</div>			
				    <!-- Modal content-->
				    <div class="modal-content">
				      <div class="modal-body">
				      		<form class="form-group" id="formNewField"  th:object="${novoSubProduto}" th:action="@{/contrato/salvarSubProduto}"	 method="POST">
							<div class="row">
									<div class="form-group" >
									<div class="col-sm-10  form-group" >
											<label for="nome" class="control-label">PRODUTO</label> 
											<select class="form-control" th:field="*{produto}">
												<option th:each="produto : ${produtos}"
													th:text="${produto} +' | ' + |${produto.tabelaComissao}  " th:value="${produto.id}"	>
												</option>
											</select>
									</div>
										
									<div class="col-sm-5  form-group"   th:classappend="${#fields.hasErrors('descricao')} ? has-error">
										<label for="nome" class="control-label">Descrição</label> 
										<input id="descricao" type="text" class="form-control"	th:field="*{descricao}" />
									</div>
	
										<div class="col-sm-3  form-group">
										  
										</div>
									</div>
							</div>
							</form>
							<div class="col-lg-12 col-md-12">		
								 <a class="btn btn-primary" id="testarImpressora" th:text="Adicionar"></a> 						
							</div>
				      </div>
				      <div class="modal-footer">
				        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				      </div>
				    </div>
			  </div>
			</div>
		
		
		
		
				<script type="text/javascript">
        /*<![CDATA[*/
			
        	
        	
        	
	        $(document).ready(function() {
	        
             	$('#dataCadastro').datetimepicker({
                    locale: 'pt-br',
                    format: 'DD/MM/YYYY'
                });	

             	$('#dataAssinatura').datetimepicker({
                    locale: 'pt-br',
                    format: 'DD/MM/YYYY'
                });
             	
             	$('#dataVigencia').datetimepicker({
                    locale: 'pt-br',
                    format: 'DD/MM/YYYY'
                });             	
			  } );  
        
			$('#testarImpressora').click(function() {
				var produto =$('#produto').val();	
				var desc =$('#descricao').val();
				alert(produto);
	         	$.ajax({ 
		        	 
		        	 success: function (data) {
		        		 if(produto == null){
		        				 $('#msg').attr("style","").text('Produto não pode estar vazio').addClass("alert alert-danger"); 		
	   							$('#produto').css({"border" : "1px solid #F00", "padding": "2px"});
		        		 }
		        		 else if(desc == ""){
		 	          		$('#msg').attr("style","").text('Descrição não pode estar vazio').addClass("alert alert-danger"); 		
   							$('#descricao').css({"border" : "1px solid #F00", "padding": "2px"});
				    	}else{
						    $('#form').attr('action', "/contrato/salvarSubProduto/"+$('#produto').val()+"/"+$('#descricao').val()).submit();
					    }
				    	  
		        	 }
		                
		         });
			 });

			
			

			
			(function($) {
				  AddTableRow = function() {

				    var newRow = $("<tr>");
				    var cols = "";

				    cols += '<td>'+$('#segurado').val()+'</td>';
				    cols += '<td>'+$('#cpf').val()+'</td>';
				    cols += '<td>';
				    cols += '<button onclick="RemoveTableRow(this)" type="button">Remover</button>';
				    cols += '</td>';

				    newRow.append(cols);
				    $("#products-table").append(newRow);

				    return false;
				  };
				})(jQuery);
			
			  
	    	/*]]>*/	
	        </script>

	</div>
</body>
</html>